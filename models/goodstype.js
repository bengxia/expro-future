/** * Created with JetBrains WebStorm. * User: Mengwei * Date: 12-5-31 * Time: 下午4:38 * To change this template use File | Settings | File Templates. */var mysql = require('../libs/mysql.js');var SimpleDO = require('../libs/simpleDO');function createGoodsType() {    return new GoodsType();};function GoodsType() {};GoodsType.prototype = new SimpleDO('`ef_goods_type`');GoodsType.prototype.findAll = function(opt, cb) {    var sql = " SELECT * FROM ef_goods_type  "        +" where 1=1 "+ opt.where;    if(opt.bt) sql += " and create_time >= "+ opt.bt;    if(opt.et) sql += " and create_time <= "+ opt.et;    if(opt.sidx && opt.sord) sql += " ORDER BY "+opt.sidx+" "+opt.sord;    if(opt.limit && opt.start) sql += " LIMIT "+ opt.start + " , "+opt.limit;    mysql.query(sql, function(err, rs) {        if(err) return cb(err);        if(!rs.length) return cb(err);        cb(err, rs);    });};GoodsType.prototype.findOne = function(opt, cb) {    var sql = " SELECT * FROM ef_goods_type "        +" where _id="+ opt._id;    mysql.query(sql, function(err, rs) {        if(err) return cb(err);        if(!rs.length) return cb(err);            cb(err, rs[0]);    });};GoodsType.prototype.create = function(body, cb) {    var opt = {        table: 'ef_goods_type',        fields: body    };    mysql.insert(opt, function(err, info) {        if(err) return cb(err);        return cb(err, info);    });};/** * 删除指定的一个或多个类型 * @param ids * @param cb */GoodsType.prototype.delete = function(opt, cb) {    var sql = " delete from ef_goods_type where _id in(" + opt._ids + ") ";    mysql.query(sql, function(err, rs) {        if(err) return cb(err);        cb(err, rs);    });};/** * 更新商品类型信息 * @param body * @param cb */GoodsType.prototype.update = function(body, cb) {    var sql = " update ef_goods_type set "        +"  parent_id='"+body.parent_id+"' "        +", level='"+body.level+"' "        +", isleaf='"+body.isleaf+"' "        +", name='"+body.name+"' "        +", comment='"+body.comment+"' "        +"  where _id="+body._id;    mysql.query(sql,        function(err, rs) {            if(err) return cb(err);            cb(err, rs);        });};exports = module.exports = createGoodsType;