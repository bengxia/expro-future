//设置前台页面显示的表格列头var colNames = ['编号', '交易号', '商品名称','交易数量','单价','总价'];//设置前台页面显示的表格数据var colModel = [    {name:'ef_deal_item._id',index:'ef_deal_item._id', width:100, align:'center',sortable:true},    {name:'ef_deal_item.deal_id',index:'ef_deal_item.deal_id', width:200, align:'center',sortable:false},    {name:'ef_deal_item.goods_name',index:'ef_deal_item.goods_name', width:200, align:'center',sortable:false},    {name:'ef_deal_item.num',index:'ef_deal_item.num', width:200, align:'center',sortable:true},    {name:'ef_deal_item.closing_cost',index:'ef_deal_item.closing_cost', width:200, align:'center',sortable:true},    {name:'ef_deal_item.total_cost',index:'ef_deal_item.total_cost', width:200,align:'center',sortable:true}];//设置前台页面所要显示的数据字段,用于数据筛选var showElement = getShowElement();//同上function getShowElement(){    var ar = new Array();    for(var i=0; i<colModel.length; i++){        ar[i] = colModel[i].name;    }    return ar;}var jsonCondition = {};function search() {    jsonCondition = array2Json(jQuery("#frmSearchCustomer").serializeArray());    jQuery("#list").trigger("reloadGrid");}//按钮事件Start$(function(){    jQuery("#list").jqGrid({        url:'/deals/'+$('#_id').val()+"?isWeb=1",        datatype: "json",        mtype: 'GET',        colNames:colNames,        colModel:colModel,        gridview:true, //加速显示        multiselect: true,  //可多选，出现多选框        multiselectWidth: 25, //设置多选列宽度        rowNum:10,        rowList:[10,20,30],        pager: '#pager',        sortname: 'total_cost',        sortorder:'desc',        viewrecords: true,        caption:"交易明细",        autowidth: true, //自动匹配宽度        height: 300,        prmNames : {            rows:"limit" // 表示请求行数的参数名称        },        loadComplete:function(data){ //完成服务器请求后，回调函数            console.log(data);            if(data.records == undefined || data.records == 0){ //如果没有记录返回，追加提示信息，删除按钮不可用                $("p").appendTo($("#list")).addClass("nodata").html('找不到相关数据！');                $("#del_btn").attr("disabled",true);            }else{ //否则，删除提示，删除按钮可用                $("p.nodata").remove();                $("#del_btn").removeAttr("disabled");            }        },        loadError:function(xhr,status,error){            $("p").appendTo($("#list")).addClass("nodata").html('查询数据出错！');            $("#del_btn").attr("disabled",true);        }    });    $(function(){        $("#find_btn").click(function(){            var obj = {};            $(".query_input").each(function(){                var key = $(this).attr('id');                var value = $(this).val();                obj[key] = value;            });            $("#list").jqGrid('setGridParam',{                url:"/deal/items/"+"!{deal_id}",                postData:obj,                page:1            }).trigger("reloadGrid");        });        $("#back_btn").click(function(){            window.location.href='/deal/index';        });    });});