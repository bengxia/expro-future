//设置前台页面显示的表格列头var colNames = ['编号', '名称', '商品类型ID', '商品类型','状态','资产编号','售价','创建时间','备注'];//设置前台页面显示的表格数据var colModel = [    {name:'_id',index:'_id', width:100, align:"center",sortable:true},    {name:'name',index:'name', width:200, align:"center",sortable:true},    {name:'type_id',index:'type_id', width:200, align:"center",sortable:true, hidden:true},    {name:'type_name',index:'type_name', width:200, align:"center",sortable:true},    {name:'state',index:'state', width:150, align:"center",sortable:true,formatter:'select', editoptions:{value:"0:下架;1:上架"}},    {name:'code',index:'code', width:200,align:"center",sortable:true},    {name:'price',index:'price', width:200, align:"center",sortable:true},    {name:'create_time',index:'create_time', width:300, align:"center",sortable:true,        formatter : 'date', formatoptions : {srcformat : 'Y-m-d',newformat : 'Y-m-d'}    },    {name:'comment',index:'comment', width:200, align:"left",sortable:true, hidden:true}];$(function(){    jQuery("#list").jqGrid({        url:'/goods?isWeb=1',        datatype: "json",        mtype: 'GET',        colNames:colNames,        colModel:colModel,        gridview:true, //加速显示        multiselect: true,  //可多选，出现多选框        multiselectWidth: 25, //设置多选列宽度        rowNum:10,        rowList:[10,20,30],        pager: '#pager',        sortname: 'create_time',        sortorder:'desc',        viewrecords: true,        caption:"商品列表",        autowidth: true, //自动匹配宽度        height: 300,        prmNames : {            rows:"limit" // 表示请求行数的参数名称        },        loadComplete:function(data){ //完成服务器请求后，回调函数            $("p.nodata").remove();            $("#del_btn").removeAttr("disabled");        },        loadError:function(xhr,status,error){            $("p").appendTo($("#list")).addClass("nodata").html('找不到相关数据！');            $("#del_btn").attr("disabled",true);        }    });    $("#popDialog").dialog({        autoOpen: false,        modal: true,        height: 800,        width: 600    });    $("#show_type").click(function(){//        $.fancybox({//            'title':'商品类型管理',//            'autoDimensions':false,//            'type':'ajax',//            'href':'/goods/type',//            'width': 500,//            'height': 600,//            'modal':true,//            'titleShow':true,//            'titlePosition':'over',//            'showCloseButton':true,//            'showNavArrows':false,//            'transitionIn': 'elastic',//（效果出入）属性值有三个：fade,elastic,none,含义分别为淡入淡出、弹性缩放、无，默认值为fade。//            'transitionOut': 'elastic',//            'centerOnScroll':false,//            'onComplete': function() {$("#fancybox-title").css({'top':'0px', 'bottom':'auto'});}//        });        $("#popDialog").dialog({            open: function(event, ui) {                $(this).load('/goods/type');            },            title: '商品类型管理'        });        $("#popDialog").dialog("open");        return false;    });//    $("#popDialog").dialog({//        autoOpen: false,//        modal: true,//        open: function ()//        {//            $(this).load('/goods/new');//        },//        height: 600,//        width: 550,//        title: '新增商品'//    });    $("#add_btn").click(function(){        $("#popDialog").dialog({            open: function(event, ui) {                $(this).load('/goods/new');            },            title: '添加新员工'        });        $("#popDialog").dialog("open");        return false;    });//    $("#add_btn111").click(function(){//        $.fancybox({//            'title':'新增商品',//            'autoDimensions':false,//            'type':'ajax',//            'href':'/goods/new',//            'width': 500,//            'height': 600,//            'modal':true,//            'titleShow':true,//            'titlePosition':'over',//            'showCloseButton':true,//            'showNavArrows':false,//            'transitionIn': 'elastic',//（效果出入）属性值有三个：fade,elastic,none,含义分别为淡入淡出、弹性缩放、无，默认值为fade。//            'transitionOut': 'elastic',//            'centerOnScroll':false,//            'onComplete': function() {$("#fancybox-title").css({'top':'0px', 'bottom':'auto'});}//        });//    });    $("#view_btn").click(function(){        var sels = $("#list").jqGrid('getGridParam','selarrrow');        if(sels==""){            $().message("请选择要查看的项！");        }else{            if(sels.toString().indexOf(',') > 0){                $().message("只可选择一项进行查看！");            }else{//                $.fancybox({//                    'title':'查看商品',//                    'autoDimensions':false,//                    'type':'ajax',//                    'href':'/goods/view/'+sels,//                    'width': 500,//                    'height': 600,//                    'modal':true,//                    'titleShow':true,//                    'titlePosition':'over',//                    'cyclic': true,//                    'showCloseButton':true,//                    'showNavArrows':false,//                    'transitionIn': 'elastic',//（效果出入）属性值有三个：fade,elastic,none,含义分别为淡入淡出、弹性缩放、无，默认值为fade。//                    'transitionOut': 'elastic',//                    'centerOnScroll':false,//                    'onComplete': function() {$("#fancybox-title").css({'top':'0px', 'bottom':'auto'});}//                });                $("#popDialog").dialog({                    open: function(event, ui) {                        $(this).load('/goods/view/'+sels);                    },                    title: '查看商品'                });                $("#popDialog").dialog("open");                return false;            }        }    });    $("#edit_btn").click(function(){        var sels = $("#list").jqGrid('getGridParam','selarrrow');        if(sels==""){            $().message("请选择要编辑的项！");        }else{            if(sels.toString().indexOf(',') > 0){                $().message("只可选择一项进行编辑！");            }else{//                $.fancybox({//                    'title':'修改商品',//                    'autoDimensions':false,//                    'type':'ajax',//                    'href':'/goods/edit/'+sels,//                    'width': 500,//                    'height': 600,//                    'modal':true,//                    'titleShow':true,//                    'titlePosition':'over',//                    'cyclic': true,//                    'showCloseButton':true,//                    'showNavArrows':false,//                    'transitionIn': 'elastic',//（效果出入）属性值有三个：fade,elastic,none,含义分别为淡入淡出、弹性缩放、无，默认值为fade。//                    'transitionOut': 'elastic',//                    'centerOnScroll':false,//                    'onComplete': function() {$("#fancybox-title").css({'top':'0px', 'bottom':'auto'});}//                });                $("#popDialog").dialog({                    open: function(event, ui) {                        $(this).load('/goods/edit/'+sels);                    },                    title: '修改商品'                });                $("#popDialog").dialog("open");                return false;            }        }    });    $("#del_btn").click(function(){        var sels = $("#list").jqGrid('getGridParam','selarrrow');        if(sels==""){            $().message("请选择要删除的项！");        }else{            if(confirm("您是否确认删除？")){                $.ajax({                    type: "delete",                    url: "/goods/"+sels,                    data: "_csrf=#{csrf}",                    beforeSend: function() {                        $().message("正在请求...");                    },                    error:function(){                        $().message("请求失败...");                    },                    success: function(data){                        if(data.goods._ids){                            var arr = data.goods._ids.split(',');                            $.each(arr,function(i,n){                                if(arr[i]!=""){                                    $("#list").jqGrid('delRowData',n);                                }                            });                            $().message("已成功删除!");                        }else{                            $().message("操作失败！");                        }                    }                });            }        }    });    $("#find_btn").click(function(){        var obj = new Object();        $(".query_input").each(function(){            var key = $(this).attr('id');            var value = $(this).val();            obj[key] = value;        });        $("#list").jqGrid('setGridParam',{            url:"/goods/index",            postData:obj,            page:1        }).trigger("reloadGrid");    });});