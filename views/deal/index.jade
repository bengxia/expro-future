!=partial('stores/sidebar')

//以下是JQuery ui的js
script(type='text/javascript', src='/libs/jquery-jquery-ui-c1dc191/ui/jquery.ui.core.js')
script(type='text/javascript', src='/libs/jquery-jquery-ui-c1dc191/ui/jquery.ui.widget.js')
script(type='text/javascript', src='/libs/jquery-jquery-ui-c1dc191/ui/jquery.ui.datepicker.js')
script(type='text/javascript', src='/libs/jquery-jquery-ui-c1dc191/ui//i18n/jquery.ui.datepicker-zh-CN.js')

script
    jQuery.jgrid.no_legacy_api = true;

//以下是一个jqGrid+fancybox的解决方案js
script(type='text/javascript', src='/libs/jqGrid_fancybox/js/i18n/grid.locale-cn.js')
script(type='text/javascript', src='/libs/jqGrid_fancybox/js/jquery.jqGrid.min.js')
script(type='text/javascript', src='/libs/jqGrid_fancybox/js/jquery.fancybox.js')
script(type='text/javascript', src='/libs/jqGrid_fancybox/js/jquery.form.js')
script(type='text/javascript', src='/libs/jqGrid_fancybox/js/jquery.message.js')

//以下是本页面引入的js文件
script(type='text/javascript', src='/javascripts/deal.js')

style
    select, input[type="file"] {
        height: 18px;
        line-height: 28px;
    }
#content
  .panel
    .header
      ul.breadcrumb
        li
          a(href='/') 主页
          span.divider /
        li.active 交易管理
    table(border='0', width='100%')
        tr
            td
                form
                    table(border='0', width='100%')
                        ////////////////////////增删改查区域Start
                        tr
                            td(width='100%', align='left', valign='baseline', colspan=4)
                                #page_operate(style='visibility:none;')
                                    //input#add_btn.btn(type='button', value='新 增')
                                    input#view_btn.btn(type='button', value='查询交易明细')
                                    //input#edit_btn.btn(type='button', value='修 改')
                                    //input#del_btn.btn(type='button', value='删 除')
                        ////////////////////////增删改查区域End
                        ////////////////////////查询条件自动生成 Start
                        isOne = 0;
                        i = 0;
                        //此处处理只有一个查询条件时的布局
                        each val, key in queryInput
                            - isOne++;
                        each val, key in queryInput
                            if(isOne == 1)
                                tr
                                    td(width='10%', align='right', valign='top')
                                        label(style="display:block;float:right;font-weight: bold") #{val}：
                                    td(width='90%', align='left', valign='top', colspan=3)
                                        input.query_input(id='#{key}', type='text')
                            else
                                if(i%2==0)
                                    tr
                                - i++;
                                td(width='15%', align='right', valign='top')
                                    label(style="display:block;float:right;font-weight: bold") #{val}：
                                td(width='35%', align='left', valign='top')
                                    input.query_input(id='#{key}', type='text')
                        tr
                            td(width='100%', align='left', valign='top', colspan=4)
                                #page_query(style='visibility:none;')
                                    input#find_btn.btn(type='button', value='查 询')
                                    input#reset_btn.btn(type='reset', value='重 置')
                        ////////////////////////查询条件自动生成 End
        tr
            td
                .inner
                    table#list
                    #pager
                    .cl.cr
    //设置前台页面显示的表格列头
    var colNames = ['编号', '交易类型', '状态','负责人','应付账款','现金支付','积分支付','支付类型','创建时间','消费会员'];
    //设置前台页面显示的表格数据
    var colModel = [
        {name:'ef_deal._id',index:'ef_deal._id', width:100, align:'center',sortable:true},
        {name:'ef_deal.type',index:'ef_deal.type', width:200, align:'center',sortable:true,formatter:'select',
            editoptions:{value:'0:消费撤销;1:消费;2:充值;3:充值撤销;4:积分增加;5:积分消费;6:积分撤销;7:退货退款;8:抽奖;9:手工调整'}},
        {name:'ef_deal.state',index:'ef_deal.state', width:200, align:'center',sortable:true,formatter:'select',
            editoptions:{value:'0:失败;1:成功'}},
        {name:'ef_member.operater_name',index:'ef_member.operater_name', width:200,align:'center',sortable:false},
        {name:'ef_deal.payment',index:'ef_deal.payment', width:200, align:'center',sortable:true},
        {name:'ef_deal.cash',index:'ef_deal.cash', width:200, align:'center',sortable:true},
        {name:'ef_deal.point',index:'ef_deal.point', width:200, align:'center',sortable:true},
        {name:'ef_deal.pay_type',index:'ef_deal.pay_type', width:200, align:'center',sortable:true,formatter:'select',
            editoptions:{value:'0:现金;1:银行卡;2:积分;3:现金+积分;4:银行卡+积分'}},
        {name:'ef_deal.create_time',index:'ef_deal.create_time', width:300, align:'center',sortable:true,
            formatter : 'date', formatoptions : {srcformat : 'Y-m-d H:i:s',newformat : 'Y-m-d H:i:s'}},
        {name:'ef_member.customer_name',index:'ef_member.customer_name', width:200,align:'center',sortable:false}];

        colNames:!{JSON.stringify(colNames)},
        colModel:!{JSON.stringify(colModel)},//由后台control中获得显示数据
