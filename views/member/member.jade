style    body { margin: 0; padding: 0; font: 80%/1.5 Arial,Helvetica,sans-serif; color: #111; background-color: #FFF; }    h2 { margin: 0px; padding: 10px; font-family: Georgia, "Times New Roman", Times, serif; font-size: 200%; font-weight: normal; color: #FFF; background-color: #CCC; border-bottom: #BBB 2px solid; }    p#copyright { margin: 20px 10px; font-size: 90%; color: #999; }    div.form-container { margin: 10px; padding: 5px; background-color: #FFF; border: #EEE 1px solid; }    p.legend { margin-bottom: 1em; }    p.legend em { color: #C00; font-style: normal; }    div.errors { margin: 0 0 10px 0; padding: 5px 10px; border: #FC6 1px solid; background-color: #FFC; }    div.errors p { margin: 0; }    div.errors p em { color: #C00; font-style: normal; font-weight: bold; }    div.form-container form p { margin: 0; }    div.form-container form p.note { margin-left: 170px; font-size: 90%; color: #aaa; }    div.form-container form fieldset { margin: 10px 0; padding: 10px; border: #DDD 1px solid; }    div.form-container form legend { font-weight: bold; color: #666; }    div.form-container form fieldset div { padding: 0.25em 0; }    div.form-container label,    div.form-container span.label { margin-right: 10px; padding-right: 10px; width: 150px; display: block; float: left; text-align: right; position: relative; }    div.form-container label.error,    div.form-container span.error { color: #C00; }    div.form-container label em,    div.form-container span.label em { position: absolute; right: 0; font-size: 120%; font-style: normal; color: #C00; }    div.form-container input{ border: #999 1px solid; }    div.form-container input.error { border-color: #C00; background-color: #FEF;border-width:1px; }    div.form-container input:focus,    div.form-container input.error:focus,    div.form-container textarea:focus {    background-color: #FFC; border-color: #FC6; }    div.form-container div.controlset label,    div.form-container div.controlset input { display: inline; float: none; }    div.form-container div.controlset div { margin-left: 170px; }    div.form-container div.buttonrow { margin-left: 180px; }.fanboxbrbr#wrapper    h2 基于css的表单模板    .form-container        form#add_form(action='/member/#{locals.member?'?_id='+member._id:''}', method='#{method}')            p.legend                strong 注意:带*号的为必填字段:(                em *                strong )            fieldset                legend                div                    input(type='hidden', name='_csrf', value='#{csrf}')                    input(type='hidden', name='_id', value='#{locals.member?member._id:''}')                    input#save.btn(type='button', value=' 保 存 ')                    input#close.btn(type='button', value=' 关 闭 ', onclick='$.fancybox.close();')            fieldset                legend 员工基本信息                div                    label.error  流水号：                    input(type='text', name='_id', value='#{locals.member?member._id:''}')                div                    label  手机号码：                    input#cellphone(type='text', name='cellphone', value='#{locals.user?user.cellphone:''}')                div                    label  员工昵称：                    input#pet_name(type='text', name='pet_name', value='#{locals.member?member.pet_name:''}')                div                    label  所属商户ID：                    input#pet_name(type='text', name='pet_name', value='1')                div                    label  角色：                        select.roleInput(name='role_id')                            optgroup(label="Type of Whatever")                                - for (var i in roles)                                    - var str = "<option value='"+roles[i]._id+"' >"+roles[i].name + " </option>"                                    - if(locals.member && roles[i]._id == member.role_id)                                        str = "<option value='"+roles[i]._id+"' selected='selected'>"+roles[i].name + " </option>"                                    | !{str}                div                    label  状态：                      select.memberInput(name='state')                            - var states = [{id:1,value:'启用'},{id:0,value:'禁用'},{id:2,value:'脱离'}];                            - for (var i in states)                                - var str = "<option value='"+states[i].id+"' >"+states[i].value + " </option>"                                - if(locals.member && states[i].id == member.state)                                      str = "<option value='"+states[i].id+"' selected='selected'>"+states[i].value + " </option>"                                | !{str}                div                    label  隐私权限：                      select.memberInput(name='privacy')                        - var states = [{id:0,value:'不开放'},{id:1,value:'基本信息开放'},{id:8,value:'完全开放'}];                        - for (var i in states)                          - var str = "<option value='"+states[i].id+"' >"+states[i].value + " </option>"                          - if(locals.member && states[i].id == member.privacy)                              str = "<option value='"+states[i].id+"' selected='selected'>"+states[i].value + " </option>"                          | !{str}                div                    label  创建时间：                    lable #{locals.member?member.create_time:''}                div                    label  到期时间：                    lable #{locals.member?member.due_time:''}                div                    label  备注：                    textarea(rows='5', cols='35', name='comment') #{locals.member?member.comment:''}            //#userPasswdContent.menuContent(style='width:350px;height:100px; display:none;text-align:center; position: absolute;background-color:#FF8040')            fieldset                legend 用户密码验证                div                    //设置密码输入隐藏层                    br                    br                    table                        tr                            td(width='30%')                                label 请输入密码：                            td(width='70%')                                input#password.memberInput(type='password', name='password', maxlength='30', value='')                        tr                            td(colspan=2)                                input#checkPasswordBt.btn(type='button', value=' 提交 ')            fieldset                legend 其他表单                div                    table(width='100%', cellpadding='0', cellspacing='0',border='0')                        tr(width='100%')                            td(width='100%', colspan=2)                        tr(width='100%')                            td(width='50%', valign='top')                                #memberContent.menuContent(style='width:400px;height:400px; text-align:center; position: absolute;background-color:#CCC')                                    //商户员工信息table                                    table#memberTable.post_table(align='center', width='100%', cellpadding='0', cellspacing='0',border='1')                                        tr(height='20px')                                            td(width='40%',align='right')                                                系统流水号：                                            td(width='60%')                                                lable #{locals.member?member._id:''}                                        tr(height='20px')                                            td(align='right') 手机号码：                                            td                                                input#cellphone.memberInput(type='text', name='cellphone', maxlength='30', value='#{locals.user?user.cellphone:''}')                                        tr(height='20px')                                            td(align='right') 员工昵称：                                            td                                                input#pet_name.memberInput(type='text', name='pet_name', maxlength='30', value='#{locals.member?member.pet_name:''}')                                        tr(height='20px')                                            td(align='right') 所属商户ID：                                            td                                              input#pet_name.memberInput(type='text', name='pet_name', maxlength='30', value='1')                                        //roles                                        tr(height='20px')                                            td(align='right') 角色：                                            td                                              select.roleInput(name='role_id')                                                - for (var i in roles)                                                  - var str = "<option value='"+roles[i]._id+"' >"+roles[i].name + " </option>"                                                  - if(locals.member && roles[i]._id == member.role_id)                                                        str = "<option value='"+roles[i]._id+"' selected='selected'>"+roles[i].name + " </option>"                                                  | !{str}                                        tr(height='20px')                                            td(align='right') 状态：                                            td                                              select.memberInput(name='state')                                                - var states = [{id:1,value:'启用'},{id:0,value:'禁用'},{id:2,value:'脱离'}];                                                - for (var i in states)                                                  - var str = "<option value='"+states[i].id+"' >"+states[i].value + " </option>"                                                  - if(locals.member && states[i].id == member.state)                                                      str = "<option value='"+states[i].id+"' selected='selected'>"+states[i].value + " </option>"                                                  | !{str}                                        tr(height='20px')                                            td(align='right') 隐私权限：                                            td                                              select.memberInput(name='privacy')                                                - var states = [{id:0,value:'不开放'},{id:1,value:'基本信息开放'},{id:8,value:'完全开放'}];                                                - for (var i in states)                                                  - var str = "<option value='"+states[i].id+"' >"+states[i].value + " </option>"                                                  - if(locals.member && states[i].id == member.privacy)                                                      str = "<option value='"+states[i].id+"' selected='selected'>"+states[i].value + " </option>"                                                  | !{str}                                        tr(height='20px')                                            td(align='right') 创建时间：                                            td                                                lable #{locals.member?member.create_time:''}                                        tr(height='20px')                                            td(align='right') 到期时间：                                            td                                                lable #{locals.member?member.due_time:''}                                        tr(height='100px')                                            td(align='right', valign='top') 备注：                                            td                                                textarea(rows='5', cols='35', name='comment') #{locals.member?member.comment:''}                            td(width='50%', valign='top')                                #userContent.menuContent(style='width:400px;height:400px; display:none;text-align:center; position: absolute;background-color:#FF8040')                                    //系统会员信息table                                    table#userTable.post_table(align='center', width='100%', cellpadding='0', cellspacing='0',border='0')                                        tr(width='100%', height='20px')                                            td(align='right') 姓名：                                            td                                                input#name.userInput(type='text', name='name', maxlength='30', value='#{locals.user?user.name:''}')                                        tr(height='20px')                                            td(align='right') 状态：                                            td                                              select#userState.userInput(name='state')                                                - var userStates = [{id:1,value:'启用'},{id:0,value:'禁用'}];                                                - for (var i in userStates)                                                  - var str = "<option value='"+userStates[i].id+"' >"+userStates[i].value + " </option>"                                                  - if(locals.user && userStates[i].id == user.state)                                                      str = "<option value='"+userStates[i].id+"' selected='selected'>"+userStates[i].value + " </option>"                                                  | !{str}                                        tr(height='20px')                                            td(align='right') 会员昵称：                                            td                                                input#user_pet_name.userInput(type='text', name='pet_name', maxlength='30', value='#{locals.user?user.pet_name:''}')                                        tr(height='20px')                                            td(align='right') 性别：                                            td                                              select#userSex.userInput(name='sex')                                                - var sexStates = [{id:1,value:'男性'},{id:0,value:'女性'}];                                                - for (var i in sexStates)                                                  - var str = "<option value='"+sexStates[i].id+"' >"+sexStates[i].value + " </option>"                                                  - if(locals.user && sexStates[i].id == user.sex)                                                      str = "<option value='"+sexStates[i].id+"' selected='selected'>"+sexStates[i].value + " </option>"                                                  | !{str}                                        tr(height='20px')                                            td(align='right') 生日：                                            td                                                input#birthday.userInput(type='text', name='birthday', maxlength='30', value='#{locals.user?user.birthday:''}')                                        tr(height='20px')                                            td(align='right') 身份证：                                            td                                                input#idcard.userInput(type='text', name='idcard', maxlength='30', value='#{locals.user?user.idcard:''}')                                        tr(height='20px')                                            td(align='right') 常用邮箱：                                            td                                                input#email.userInput(type='text', name='email', maxlength='30', value='#{locals.user?user.email:''}')                                        tr(height='20px')                                            td(align='right') 会员创建时间：                                            td                                                lable#user_create_time #{locals.user?user.create_time:''}                                        tr(height='100px')                                            td(align='right', valign='top') 会员备注：                                            td                                                textarea#userComment(rows='5', cols='50', name='comment') #{locals.user?user.comment:''}script(type='text/javascript')    $(document).ready(function(){        $.ajax({            type: "Get",            url: '/merchants/list',            dataType: "json",            global: false,            async: false,            success: function (res) {                if(res.status == 200 && res.merchants) {                    $.each(res.merchants,function(i,ele){                        if(ele){                        }                    });                }            },            error: function () {                alert("Ajax请求数据失败!");            }        });    });    $(function(){      $('#add_form').ajaxForm({          beforeSubmit: validate,          success: function(msg){              if(msg.status=='success'){                  $().message("成功添加");                  $("#list").trigger("reloadGrid", [{current:true}]);              }else{                $().message("添加失败:"+msg.status);              }          }      });      pageInit();    });    function validate(formData, jqForm, options) {      /*        $(".memberInput").each(function(){            alert($(this).val())          });      for (var i=0; i < formData.length; i++) {          if (!formData[i].value) {              $().message("<b>请输入完整相关信息</b>");              return false;          }      }*/      $.fancybox.close();//为防止因为网络延时造成对话框不关闭，再次输入，提前关闭对话框。      $().message("正在提交...");    };    $("#save").click(function(){        var val = $('#cellphone').attr("value");        if(!val || val.trim() == ""){            return $().message("请您输入手机号码");        }        $.ajax({            type: "Get",            url: '/user/'+$('#cellphone').attr("value"),            dataType: "json",            global: false,            async: false,            success: function (res) {                if(res.status == 200) {                    $().message("手机号码已已存在，请输入登陆密码进行验证！");//有用户                    var obj = $("#cellphone");                    var objOffset = obj.offset();                    var dialogOffset = $("#fancybox-inner").offset();                    var left = objOffset.left - dialogOffset.left;                    var top = objOffset.top - dialogOffset.top;                    $("#userPasswdContent").css({left:left + "px", top:top + obj.outerHeight() + "px"}).slideDown("fast");                }                else if (res.status == 204) return $().message("恭喜，此手机号码允许注册！");//无用户                else                    return $().message(res.error);//有错            },            error: function () {                alert("Ajax请求数据失败!");            }        });    });    $("#checkPasswordBt").click(function(){        var cellphone = $('#cellphone').attr("value");        var pass = $('#password').attr("value");        if(!cellphone || cellphone.trim() == ""){            return $().message("请您输入手机号码！");        }        if(!pass || pass.trim() == ""){            return $().message("请您输入密码！");        }        $.ajax({            type: "Get",            url: '/user/'+cellphone+'/'+pass,            dataType: "json",            global: false,            async: false,            success: function (res) {                if(res.status == 200) {                    $().message("恭喜，你输入的密码已通过验证！");                    hideMenu();                    $("#name").val(res.user.name);                    $("#userState").val(res.user.state);                    $("#userSex").val(res.user.sex);                    $("#user_pet_name").val(res.user.pet_name);                    $("#birthday").val(res.user.birthday);                    $("#idcard").val(res.user.idcard);                    $("#email").val(res.user.email);                    $("#user_create_time").html(res.user.create_time);                    $("#userComment").val(res.user.comment);                    $("#userContent").slideDown("fast");                }                else                    $().message(res.error);            },            error: function () {                alert("Ajax请求数据失败!");            }        });    });    function hideMenu() {        $("#userPasswdContent").fadeOut("fast");        //$("body").unbind("mousedown", onBodyDown);    }    //页面初始化时调用，设置按钮显示，输入框是否只读等属性。    function pageInit(){        if(#{isReadonly}){            $(".memberInput").attr("readonly","readonly");        }        if(#{!isShowSaveBt}){            $("#save").hide();        }    };